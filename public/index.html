<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypescord Messenger</title>
    
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="auth-screen" style="display: none;">
        <div class="auth-container">
            <h1>Hypescord</h1>
            <div class="tabs">
                <button onclick="showAuth('login')" class="active">–í—Ö–æ–¥</button>
                <button onclick="showAuth('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <form id="login-form" action="/login" method="POST" style="display: block;">
                <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>

            <form id="register-form" action="/register" method="POST" enctype="multipart/form-data" style="display: none;">
                <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <label for="avatar-upload" class="avatar-label">
                    –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                    <input type="file" id="avatar-upload" name="avatar" accept="image/*">
                </label>
                <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
        </div>
    </div>


    <div id="app-screen" style="display: none;">
        <div class="sidebar">
            <div class="user-profile">
                <img id="current-user-avatar" src="" alt="Avatar">
                <span id="current-username"></span>
                <button class="icon-btn" onclick="toggleSettings()">
                    <i class="material-icons">settings</i> 
                </button>
            </div>

            <div class="sidebar-header">
                <h2>–î—Ä—É–∑—å—è</h2>
                <button class="icon-btn" onclick="toggleRequestModal()">
                    <i class="material-icons">group_add</i> 
                </button>
            </div>
            
            <div class="friends-list" id="friends-list">
                </div>
            
            <div class="sidebar-footer">
                 <button class="sidebar-btn" onclick="openChat('general-demo')">
                    <i class="material-icons">forum</i>
                    <span>#general-demo</span>
                </button>
                <a href="/logout" class="sidebar-btn logout-btn">–í—ã—Ö–æ–¥</a>
            </div>
        </div>

        <div class="main-content">
            <header>
                <h2 id="chat-with-name">#general-demo</h2>
                <div class="chat-actions">
                    <button id="call-btn" class="icon-btn call-btn" onclick="startCall()" style="display: none;">
                         <i class="material-icons">phone</i> 
                    </button>
                </div>
            </header>
            
            <div class="messages-container" id="messages-container">
                </div>

            <div class="chat-input">
                <div class="file-input-wrapper">
                    <button class="icon-btn">
                        <i class="material-icons">attachment</i> 
                    </button>
                    <input type="file" id="file-input" onchange="sendFile(this.files)" accept="image/jpeg,image/png,audio/mp3,video/mp4">
                </div>
                
                <input type="text" id="msg-input" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeydown="if(event.key==='Enter') sendMessage()">
                <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    
    <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="toggleSettings()"><i class="material-icons">close</i></button>
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="setting-item">
                <span>–¢–µ–∫—É—â–∞—è —Ç–µ–º–∞: </span>
                <span id="current-theme-name">–¢–µ–º–Ω–∞—è</span>
            </div>
            <div class="setting-item">
                <button id="theme-btn" onclick="toggleTheme()">–°–º–µ–Ω–∏—Ç—å –Ω–∞ –°–≤–µ—Ç–ª—É—é</button>
            </div>
            
        </div>
    </div>
    
    <div id="requests-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="toggleRequestModal()"><i class="material-icons">close</i></button>
            <h2>–ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h2>
            <div id="friend-requests-list">
                </div>
            
            <hr style="margin: 20px 0;">
            
            <h3>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</h3>
            <input type="text" id="friend-req-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <button class="accept-btn" onclick="sendFriendRequest()" style="width: 100%; margin-top: 10px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>
    
    <div id="incoming-call-box" class="modal-call-status" style="display: none;">
        <div class="modal-content">
            <h3>–í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫ –æ—Ç <span id="caller-name">...</span></h3>
            <div class="call-controls">
                <button onclick="answerCall()" class="accept-btn">
                     <i class="material-icons">video_call</i>
                </button>
                <button onclick="rejectCall()" class="reject-btn">
                     <i class="material-icons">call_end</i>
                </button>
            </div>
        </div>
    </div>
    
    <div id="awaiting-answer-box" class="modal-call-status" style="display: none;">
        <div class="modal-content">
            <h3>üìû –í—ã–∑–æ–≤: <span id="calling-name">...</span></h3>
            <p>–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞...</p>
            <button onclick="endCall()" class="reject-btn">
                <i class="material-icons">call_end</i>
            </button>
        </div>
    </div>

    <div id="call-ui" class="call-overlay" style="display: none;">
        <div class="call-header">
            –ó–≤–æ–Ω–æ–∫ —Å <span id="current-call-partner"></span>
        </div>
        
        <div class="video-grid">
            <div class="video-container remote">
                <video id="remote-video" autoplay playsinline></video>
                <div class="video-placeholder">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>
            </div>

            <div class="video-container local">
                <video id="local-video" muted autoplay playsinline></video>
                <div class="video-placeholder">–í–∞—à–µ –≤–∏–¥–µ–æ</div>
                
                <div id="local-screen-indicator" style="display: none;" class="screen-indicator">
                    <span class="live-tag">üñ•Ô∏è –í –≠–§–ò–†–ï</span>
                </div>
            </div>

            <div class="video-container screen-share">
                <video id="screen-share-video" autoplay playsinline style="display: none;"></video>
            </div>
        </div>

        <div class="call-controls">
            <button id="mic-toggle" class="control-btn" onclick="toggleMic()">
                <i class="material-icons">mic</i>
            </button>

            <button id="camera-toggle" class="control-btn" onclick="toggleCamera()">
                <i class="material-icons">videocam</i>
            </button>

            <button id="screen-share-toggle" class="control-btn" onclick="toggleScreenShare()">
                <i class="material-icons">screen_share</i>
            </button>

            <button class="control-btn end-call-btn" onclick="endCall()">
                <i class="material-icons">call_end</i>
            </button>
        </div>
    </div>


    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>
</html>