<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hypescord Messenger</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="auth-screen" style="display: none;">
        <div class="auth-container">
            <h1>Hypescord</h1>
            <div class="tabs">
                <button onclick="showAuth('login')" class="active">–í—Ö–æ–¥</button>
                <button onclick="showAuth('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
            </div>

            <form id="login-form" action="/login" method="POST" style="display: block;">
                <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <button type="submit">–í–æ–π—Ç–∏</button>
            </form>

            <form id="register-form" action="/register" method="POST" enctype="multipart/form-data" style="display: none;">
                <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required>
                <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required>
                <label for="avatar-upload" class="avatar-label">
                    –ó–∞–≥—Ä—É–∑–∏—Ç—å –∞–≤–∞—Ç–∞—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                    <input type="file" id="avatar-upload" name="avatar" accept="image/*">
                </label>
                <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
            </form>
        </div>
    </div>


    <div id="app-screen" style="display: none;">
        <div class="sidebar">
            <div class="user-profile">
                <img id="current-user-avatar" src="" alt="Avatar">
                <span id="current-username"></span>
                <button class="icon-btn" onclick="toggleSettings()">
                    <svg class="icon-cog" viewBox="0 0 24 24"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7zm0 2a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11zm9.46 2.87-2.34-1.46c-.63.48-1.34.82-2.1.99l-.33 2.45h-4.38l-.33-2.45c-.76-.17-1.47-.51-2.1-.99L2.54 17.37l-1.07-1.06 1.6-2.77c.32-.56.45-1.19.45-1.84s-.13-1.28-.45-1.84L1.47 7.69l1.07-1.06 2.34 1.46c.63-.48 1.34-.82 2.1-.99L7.38 4.65h4.38l.33 2.45c.76.17 1.47.51 2.1.99l2.34-1.46 1.07 1.06-1.6 2.77c-.32.56-.45 1.19-.45 1.84s.13 1.28.45 1.84l1.6 2.77-1.07 1.06-2.34-1.46c-.63.48-1.34.82-2.1.99l-.33 2.45h-4.38l-.33-2.45c-.76-.17-1.47-.51-2.1-.99L5.385 16.615z"></path></svg>
                </button>
            </div>

            <div class="sidebar-header">
                <h2>–î—Ä—É–∑—å—è</h2>
                <button class="icon-btn" onclick="toggleRequestModal()">
                    <svg class="icon-users" viewBox="0 0 24 24"><path d="M12.016 11.514c.264-.523.585-1.01.956-1.442C13.568 9.25 14.28 8.65 15 8c-.68-.65-1.392-1.25-2.028-1.922-.371-.432-.692-.919-.956-1.442-.264-.523-.483-1.082-.656-1.674C11.192 2.378 11 1.748 11 1h2c0 .748-.192 1.378-.544 1.962-.173.592-.392 1.151-.656 1.674-.264.523-.585 1.01-.956 1.442C10.432 7.25 9.72 7.85 9 8c.68.65 1.392 1.25 2.028 1.922.371.432.692.919.956 1.442.264.523.483 1.082.656 1.674C12.808 15.622 13 16.252 13 17h-2c0-.748.192-1.378.544-1.962.173-.592.392-1.151.656-1.674zM12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12zM5.385 16.615l-1.06-1.06 1.6-2.77C6.24 12.24 6.375 11.61 6.375 10.965S6.24 9.7 5.865 9.065L4.325 6.295l1.06-1.06 2.34 1.46c.63-.48 1.34-.82 2.1-.99L10.15 4.65h4.38l.33 2.45c.76.17 1.47.51 2.1.99l2.34-1.46 1.06 1.06-1.6 2.77c-.375.645-.51 1.275-.51 1.92s.135 1.275.51 1.92l1.6 2.77-1.06 1.06-2.34-1.46c-.63.48-1.34.82-2.1.99l-.33 2.45h-4.38l-.33-2.45c-.76-.17-1.47-.51-2.1-.99L5.385 16.615z"/></svg>
                </button>
            </div>
            
            <div class="friends-list" id="friends-list">
                </div>
            
            <div class="sidebar-footer">
                 <button class="sidebar-btn" onclick="openChat('general-demo')">
                    <svg class="icon-chat" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
                    <span>#general-demo</span>
                </button>
                <a href="/logout" class="sidebar-btn logout-btn">–í—ã—Ö–æ–¥</a>
            </div>
        </div>

        <div class="main-content">
            <header>
                <h2 id="chat-with-name">#general-demo</h2>
                <div class="chat-actions">
                    <button id="call-btn" class="icon-btn call-btn" onclick="startCall()" style="display: none;">
                        <svg class="icon-phone" viewBox="0 0 24 24"><path d="M16 3H8c-1.1 0-1.99.9-1.99 2L6 19c0 1.1.89 2 1.99 2H16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2.5 16h-3c-.28 0-.5-.22-.5-.5s.22-.5.5-.5h3c.28 0 .5.22.5.5s-.22.5-.5.5zm.5-4H9V8h6v7z"/></svg>
                    </button>
                </div>
            </header>
            
            <div class="messages-container" id="messages-container">
                </div>

            <div class="chat-input">
                <div class="file-input-wrapper">
                    <button class="icon-btn">
                        <svg class="icon-attachment" viewBox="0 0 24 24"><path d="M16.5 6v11.5c0 2.21-1.79 4-4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V6h-1.5z"/></svg>
                    </button>
                    <input type="file" id="file-input" onchange="sendFile(this.files)" accept="image/jpeg,image/png,audio/mp3,video/mp4">
                </div>
                
                <input type="text" id="msg-input" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <button onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    
    <div id="settings-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="toggleSettings()"><svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            
            <div class="setting-item">
                <span>–¢–µ–∫—É—â–∞—è —Ç–µ–º–∞: </span>
                <span id="current-theme-name">–¢–µ–º–Ω–∞—è</span>
            </div>
            <div class="setting-item">
                <button id="theme-btn" onclick="toggleTheme()">–°–º–µ–Ω–∏—Ç—å –Ω–∞ –°–≤–µ—Ç–ª—É—é</button>
            </div>
            
        </div>
    </div>
    
    <div id="requests-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <button class="close-btn" onclick="toggleRequestModal()"><svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button>
            <h2>–ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h2>
            <div id="friend-requests-list">
                </div>
            
            <hr style="margin: 20px 0;">
            
            <h3>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å</h3>
            <input type="text" id="friend-req-input" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
            <button class="accept-btn" onclick="sendFriendRequest()" style="width: 100%; margin-top: 10px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</lbutton>
        </div>
    </div>
    
    <div id="incoming-call-box" class="modal-call-status" style="display: none;">
        <div class="modal-content">
            <h3>–í—Ö–æ–¥—è—â–∏–π –∑–≤–æ–Ω–æ–∫ –æ—Ç <span id="caller-name">...</span></h3>
            <div class="call-controls">
                <button onclick="answerCall()" class="accept-btn">
                     <svg class="icon-video" viewBox="0 0 24 24"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/></svg>
                </button>
                <button onclick="rejectCall()" class="reject-btn">
                     <svg class="icon-phone-end" viewBox="0 0 24 24"><path d="M12 9c-1.39 0-2.78.33-4.08 1.05l-2.07-2.07c1.47-.79 3.09-1.28 4.65-1.28 1.56 0 3.02.42 4.31 1.25l-2.12 2.12c-.79-.38-1.63-.61-2.73-.61zm-4 7c1.39 0 2.78-.33 4.08-1.05l2.07 2.07c-1.47.79-3.09 1.28-4.65 1.28-1.56 0-3.02-.42-4.31-1.25l2.12-2.12c.79.38 1.63.61 2.73.61zm4-3c-1.11 0-2-.89-2-2s.89-2 2-2 2 .89 2 2-.89 2-2 2z"/></svg>
                </button>
            </div>
        </div>
    </div>
    
    <div id="awaiting-answer-box" class="modal-call-status" style="display: none;">
        <div class="modal-content">
            <h3>üìû –í—ã–∑–æ–≤: <span id="calling-name">...</span></h3>
            <p>–û–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞...</p>
            <button onclick="endCall()" class="reject-btn">
                <svg class="icon-phone-end" viewBox="0 0 24 24"><path d="M12 9c-1.39 0-2.78.33-4.08 1.05l-2.07-2.07c1.47-.79 3.09-1.28 4.65-1.28 1.56 0 3.02.42 4.31 1.25l-2.12 2.12c-.79-.38-1.63-.61-2.73-.61zm-4 7c1.39 0 2.78-.33 4.08-1.05l2.07 2.07c-1.47.79-3.09 1.28-4.65 1.28-1.56 0-3.02-.42-4.31-1.25l2.12-2.12c.79.38 1.63.61 2.73.61zm4-3c-1.11 0-2-.89-2-2s.89-2 2-2 2 .89 2 2-.89 2-2 2z"/></svg>
            </button>
        </div>
    </div>

    <div id="call-ui" class="call-overlay" style="display: none;">
        <div class="call-header">
            –ó–≤–æ–Ω–æ–∫ —Å <span id="current-call-partner"></span>
        </div>
        
        <div class="video-grid">
            <div class="video-container remote">
                <video id="remote-video" autoplay playsinline></video>
                <div class="video-placeholder">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>
            </div>

            <div class="video-container local">
                <video id="local-video" muted autoplay playsinline></video>
                <div class="video-placeholder">–í–∞—à–µ –≤–∏–¥–µ–æ</div>
                
                <div id="local-screen-indicator" style="display: none;" class="screen-indicator">
                    <span class="live-tag">üñ•Ô∏è –í –≠–§–ò–†–ï</span>
                </div>
            </div>

            <div class="video-container screen-share">
                <video id="screen-share-video" autoplay playsinline style="display: none;"></video>
            </div>
        </div>

        <div class="call-controls">
            <button id="mic-toggle" class="control-btn" onclick="toggleMic()">
                <svg class="icon-mic" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.2-3c0 2.68-2.07 4.87-4.7 5.16V19h2c.55 0 1 .45 1 1s-.45 1-1 1h-4c-.55 0-1-.45-1-1s.45-1 1-1h2v-2.84c-2.63-.29-4.7-2.48-4.7-5.16H5c0 3.41 2.72 6.23 6 6.72V22h2v-4.28c3.28-.49 6-3.31 6-6.72h-1.8z"/></svg>
            </button>

            <button id="camera-toggle" class="control-btn" onclick="toggleCamera()">
                <svg class="icon-video" viewBox="0 0 24 24"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"/></svg>
            </button>

            <button id="screen-share-toggle" class="control-btn" onclick="toggleScreenShare()">
                <svg class="icon-screen-share" viewBox="0 0 24 24"><path d="M18 10V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h13c.55 0 1-.45 1-1v-3l4 4V6l-4 4zM16 16H5V8h11v8z"/></svg>
            </button>

            <button class="control-btn end-call-btn" onclick="endCall()">
                <svg class="icon-phone-end" viewBox="0 0 24 24"><path d="M12 9c-1.39 0-2.78.33-4.08 1.05l-2.07-2.07c1.47-.79 3.09-1.28 4.65-1.28 1.56 0 3.02.42 4.31 1.25l-2.12 2.12c-.79-.38-1.63-.61-2.73-.61zm-4 7c1.39 0 2.78-.33 4.08-1.05l2.07 2.07c-1.47.79-3.09 1.28-4.65 1.28-1.56 0-3.02-.42-4.31-1.25l2.12-2.12c.79.38 1.63.61 2.73.61zm4-3c-1.11 0-2-.89-2-2s.89-2 2-2 2 .89 2 2-.89 2-2 2z"/></svg>
            </button>
        </div>
    </div>


    <script src="/socket.io/socket.io.js"></script>
    <script src="client.js"></script>
</body>
</html>